<style>
    td a {
      text-decoration: none;
    }
    .btn-outline-dark {
      padding: 4px 10px;
      font-size: 0.9rem;
      font-weight: 500;
    }
  </style>
  <div class="d-flex" style="gap: 10px" *ngIf="selectedFileIds.length > 0">
    <button type="button" class="btn btn-outline-dark" (click)="downloadFiles()">Download</button>
    <button type="button" class="btn btn-outline-dark" data-bs-toggle="modal" data-bs-target="#deleteModal">Delete</button>
  </div>
<table class="table">
    <thead>
      <tr>
        <th scope="col">Name</th>
        <th scope="col">Length</th>
        <th scope="col">Modified</th>
      </tr>
    </thead>
    <tbody>
        <tr *ngFor="let folder of folders">
          <td>
            <svg  width="20px" height="20px" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="#000000"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <defs> <rect id="folder-a" width="18" height="4"></rect> <path id="folder-c" d="M2,2 L2,4 C2,4.55228475 1.55228475,5 1,5 C0.44771525,5 0,4.55228475 0,4 L0,1 C0,0.44771525 0.44771525,0 1,0 L7,0 C7.26521649,0 7.5195704,0.10535684 7.70710678,0.292893219 L9.41421356,2 L19,2 C19.5522847,2 20,2.44771525 20,3 L20,17 C20,17.5522847 19.5522847,18 19,18 L1,18 C0.44771525,18 0,17.5522847 0,17 L0,7 C0,6.44771525 0.44771525,6 1,6 L18,6 L18,4 L9,4 C8.73478351,4 8.4804296,3.89464316 8.29289322,3.70710678 L6.58578644,2 L2,2 Z M18,8 L2,8 L2,16 L18,16 L18,8 Z"></path> </defs> <g fill="none" fill-rule="evenodd" transform="translate(2 3)"> <g transform="translate(1 13)"> <mask id="folder-b" fill="#ffffff"> <use xlink:href="#folder-a"></use> </mask> <use fill="#D8D8D8" xlink:href="#folder-a"></use> <g fill="#ffffff" mask="url(#folder-b)"> <rect width="24" height="24" transform="translate(-3 -16)"></rect> </g> </g> <mask id="folder-d" fill="#ffffff"> <use xlink:href="#folder-c"></use> </mask> <use fill="#000000" fill-rule="nonzero" xlink:href="#folder-c"></use> <g fill="#000000" mask="url(#folder-d)"> <rect width="24" height="24" transform="translate(-2 -3)"></rect> </g> </g> </g></svg>
            <a [href]="'/folders/' + folder.id" >{{folder.name}}</a>
          </td>
          <td>
            {{  folder.size}}
          </td>
          <td>
            {{ folder.lastModified| date:'medium' }}
          </td>
        </tr>
        <ng-container *ngFor="let file of files">
          <tr #row (mouseenter)="lastHoverIdx = files.indexOf(file)" (mouseleave)="lastHoverIdx = -1" [style.background-color]="selectedFileIds.includes(file.id) ? 'rgb(221, 240, 252)' : 'transparent'" (click)="selectSingleRow($event, file.id)">
            <td>
              <div class="form-check" *ngIf="lastHoverIdx == files.indexOf(file) || selectedFileIds.length > 0" style="position: absolute; left: 80px; margin: 0; padding: 0; z-index: 2;">
                <input #checkbox class="form-check-input" type="checkbox" value="" id="flexCheckDefault" (click)="$event.stopPropagation()"  (change)="changeFilesSelection(checkbox.checked, file)" [checked]="selectedFileIds.includes(file.id)">
              </div>
              <a [href]="'/api/files/open/' + file.id" target="_blank">
                {{ file.filename }} 
              </a>
            </td>
            <td>
              {{  file.length }}
            </td>
            <td>
              {{  file.modified | date:'medium' }}
            </td>
          </tr>
        </ng-container>
    </tbody>
  </table>


  <div class="modal fade" id="deleteModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
  aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Delete {{selectedFileIds.length}} {{selectedFileIds.length == 1 ? 'file' : 'files'}}?</h5>
        <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <p>Are you sure you want to delete {{selectedFileIds.length}} {{selectedFileIds.length == 1 ? 'file' : 'files'}}?</p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
        <button type="button" class="btn btn-primary"  data-bs-dismiss="modal" (click)="deleteFiles()">Delete</button>
      </div>
    </div>
  </div>
</div>
